(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Member"],{3419:function(t,e,r){"use strict";r("8050")},"539e":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"contentMt",attrs:{id:"orders"}},[r("b-container",[r("b-table",{attrs:{items:t.orders,fields:t.fields},scopedSlots:t._u([{key:"cell(date)",fn:function(e){return[t._v(t._s(new Date(e.item.date).toLocaleString("zh-tw")))]}},{key:"cell(price)",fn:function(e){return[t._v(t._s(t.sumPrice(e.item.products)))]}},{key:"cell(deliveryDate)",fn:function(e){return[t._v(t._s(e.item.userInfo.deliveryDate))]}},{key:"cell(deliveryTime)",fn:function(e){return[t._v(t._s(e.item.userInfo.deliveryTime))]}},{key:"cell(products)",fn:function(e){return[r("ul",t._l(e.item.products,(function(e){return r("li",{key:e._id},[t._v(t._s(e.product.name)+" x "+t._s(e.quantity))])})),0)]}}])})],1)],1)},n=[],o=r("1da1"),s=(r("96cf"),r("d3b7"),{data:function(){return{orders:[],fields:[{key:"_id",label:"單號"},{key:"products",label:"商品"},{key:"price",label:"總金額"},{key:"deliveryDate",label:"欲送日期"},{key:"deliveryTime",label:"時間"},{key:"date",label:"訂購日"}]}},methods:{sumPrice:function(t){var e=t.reduce((function(t,e){return t+e.quantity*e.product.price}),0);return console.log(e),new Intl.NumberFormat("en-IN").format(e)}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/orders/me",{headers:{authorization:"Bearer "+t.user.token}});case 3:r=e.sent,a=r.data,t.orders=a.result,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"取得訂單失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),i=s,c=r("2877"),l=Object(c["a"])(i,a,n,!1,null,null,null);e["default"]=l.exports},"5f79":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"top"}},[a("div",{staticClass:"w-100 fixed-top",attrs:{id:"nav"}},[a("div",{staticClass:"text-right py-3 pr-3"},[t.user.isLogin?t._e():a("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-1",modifiers:{"modal-1":!0}}],attrs:{variant:"light"}},[a("b-icon-person-fill",{staticClass:"iconColor"})],1),t.user.isLogin&&t.user.isAdmin?a("b-btn",{staticClass:"ml-2",attrs:{to:"/back/admin/adminproducts",variant:"warning"}},[t._v("後臺管理")]):t._e(),t.user.isLogin&&!t.user.isAdmin?a("b-btn",{staticClass:"mr-4",attrs:{to:"/back/member/memberorders",variant:"warning"}},[t._v("訂單查詢")]):t._e(),t.user.isLogin&&!t.user.isAdmin?a("b-btn",{attrs:{to:"/back/member/membercart",variant:"light"}},[a("font-awesome-icon",{staticClass:"iconColor",attrs:{icon:["fas","fa-cart-plus"]}}),a("b-badge",{attrs:{variant:"danger"}},[t._v(t._s(t.user.cart))])],1):t._e(),t.user.isLogin?a("b-btn",{attrs:{variant:"light"},on:{click:t.logout}},[a("font-awesome-icon",{staticClass:"iconColor my-0",attrs:{icon:["fas","fa-right-from-bracket"]}})],1):t._e(),t.user.isLogin?a("b-avatar",{attrs:{variant:"info",src:t.user.avatar}}):t._e(),a("b-modal",{ref:"my-modal",attrs:{id:"modal-1","hide-footer":""},on:{hidden:t.hideModal}},[a("b-tabs",{attrs:{align:"around"}},[a("b-tab",{staticClass:"text-center my-5",attrs:{title:"會員登入",active:""}},[a("img",{staticClass:"a",staticStyle:{height:"200px",cursor:"pointer"},attrs:{src:r("c709")},on:{click:t.signForLine}}),a("h4",[t._v("Line 快速登入")])]),a("b-tab",{attrs:{title:"管理者登入"}},[a("b-form",{on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[a("b-form-group",{attrs:{label:"帳號","label-for":"input-account",description:"帳號長度為 4 到 20 個字",state:t.state.account,"invalid-feedback":"帳號格式不正確"}},[a("b-form-input",{attrs:{id:"input-account",required:"",placeholder:"請輸入帳號",type:"text",state:t.state.account},model:{value:t.form.account,callback:function(e){t.$set(t.form,"account",e)},expression:"form.account"}})],1),a("b-form-group",{attrs:{label:"密碼","label-for":"input-account",description:"帳號長度為 4 到 20 個字",state:t.state.account,"invalid-feedback":"帳號格式不正確"}},[a("b-form-input",{attrs:{id:"input-account",required:"",placeholder:"請輸入密碼",type:"password",state:t.state.password},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("div",{staticClass:"text-center"},[a("b-btn",{staticClass:"mx-1",attrs:{variant:"warning",type:"sumbit"}},[t._v("登入")])],1)],1)],1)],1)],1)],1),a("div",{staticClass:"themeColor"},[a("b-navbar",{staticClass:"align-items-center h-100",attrs:{toggleable:"lg",type:"dark"}},[a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{staticClass:"mx-auto"},[a("b-nav-item",{staticClass:"h4 my-0 navWord homePage",attrs:{to:"/"}},[t._v("首頁")]),a("b-nav-item",{staticClass:"h4 my-0 navWord",attrs:{to:"/about"}},[t._v("關於我們")]),a("b-nav-item",{staticClass:"h4 my-0 navWord",attrs:{to:"/products"}},[t._v("商品介紹")]),a("b-nav-item",{staticClass:"logoimg",attrs:{to:"/"}},[a("span",{attrs:{id:"space"}},[a("div",{staticClass:"box"})])]),a("b-nav-item",{staticClass:"h4 my-0 navWord",staticStyle:{"margin-right":"18px"},attrs:{to:"/language"}},[t._v("花語大全")]),a("b-nav-item",{staticClass:"h4 my-0 navWord",attrs:{to:"/care"}},[t._v("花の呵護")])],1)],1)],1)],1)]),a("div",{attrs:{id:"content"}},[a("router-view")],1),a("div",{staticClass:"mt-5",staticStyle:{height:"52px"},attrs:{id:"footer"}},[a("b-col",{staticClass:"text-center",attrs:{md:"12"}},[t._v("© 2022 Fish Yang")]),a("b-col",{staticClass:"text-center",attrs:{md:"12"}},[t._v("圖片來源：取自網路｜僅學習用途，無商業使用")])],1),t.btnFlag?a("div",{staticClass:"top",staticStyle:{width:"60px",height:"60px","border-radius":"50%",background:"#D95D5E"},on:{click:t.backTop}},[a("font-awesome-icon",{attrs:{icon:["fas","fa-arrow-up"],size:"2x"}})],1):t._e()])},n=[],o=r("1da1"),s=(r("96cf"),{data:function(){return{form:{account:"",password:""},btnFlag:!1}},mounted:function(){window.addEventListener("scroll",this.scrollToTop)},destroyed:function(){window.removeEventListener("scroll",this.scrollToTop)},methods:{login:function(){this.$refs["my-modal"].hide(),this.$store.dispatch("user/login",this.form)},logout:function(){this.$store.dispatch("user/logout")},hideModal:function(){this.form.account="",this.form.password=""},random:function(t){return Math.floor(Math.random()*t)},signForLine:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r="https://access.line.me/oauth2/v2.1/authorize?",r+="response_type=code",r+="&client_id=1656834338,",r+="&redirect_uri=https://mfflowershop.herokuapp.com/users/line,",r+="&state="+t.randomState,r+="&bot_prompt=normal",r+="&scope=openid%20profile",window.location.href=r;case 8:case"end":return e.stop()}}),e)})))()},backTop:function(){var t=this,e=setInterval((function(){var r=Math.floor(-t.scrollTop/5);document.documentElement.scrollTop=document.body.scrollTop=t.scrollTop+r,0===t.scrollTop&&clearInterval(e)}),16)},scrollToTop:function(){var t=this,e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;t.scrollTop=e,t.scrollTop>50?t.btnFlag=!0:t.btnFlag=!1}},computed:{state:function(){return{account:0===this.form.account.length?null:this.form.account.length>=4,password:0===this.form.password.length?null:this.form.password.length>=4}}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("user/getInfo"),t.$store.dispatch("user/signInLine");case 2:case"end":return e.stop()}}),e)})))()}}),i=s,c=(r("3419"),r("2877")),l=Object(c["a"])(i,a,n,!1,null,null,null);e["default"]=l.exports},8050:function(t,e,r){},a434:function(t,e,r){"use strict";var a=r("23e7"),n=r("da84"),o=r("23cb"),s=r("5926"),i=r("07fa"),c=r("7b0b"),l=r("65f0"),u=r("8418"),d=r("1dde"),m=d("splice"),f=n.TypeError,p=Math.max,b=Math.min,v=9007199254740991,h="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!m},{splice:function(t,e){var r,a,n,d,m,g,k=c(this),y=i(k),w=o(t,y),x=arguments.length;if(0===x?r=a=0:1===x?(r=0,a=y-w):(r=x-2,a=b(p(s(e),0),y-w)),y+r-a>v)throw f(h);for(n=l(k,a),d=0;d<a;d++)m=w+d,m in k&&u(n,d,k[m]);if(n.length=a,r<a){for(d=w;d<y-a;d++)m=d+a,g=d+r,m in k?k[g]=k[m]:delete k[g];for(d=y;d>y-a+r;d--)delete k[d-1]}else if(r>a)for(d=y-a;d>w;d--)m=d+a-1,g=d+r-1,m in k?k[g]=k[m]:delete k[g];for(d=0;d<r;d++)k[d+w]=arguments[d+2];return k.length=y-a+r,n}})},b0c0:function(t,e,r){var a=r("83ab"),n=r("5e77").EXISTS,o=r("e330"),s=r("9bf2").f,i=Function.prototype,c=o(i.toString),l=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,u=o(l.exec),d="name";a&&!n&&s(i,d,{configurable:!0,get:function(){try{return u(l,c(this))[1]}catch(t){return""}}})},e9c4:function(t,e,r){var a=r("23e7"),n=r("da84"),o=r("d066"),s=r("2ba4"),i=r("e330"),c=r("d039"),l=n.Array,u=o("JSON","stringify"),d=i(/./.exec),m=i("".charAt),f=i("".charCodeAt),p=i("".replace),b=i(1..toString),v=/[\uD800-\uDFFF]/g,h=/^[\uD800-\uDBFF]$/,g=/^[\uDC00-\uDFFF]$/,k=function(t,e,r){var a=m(r,e-1),n=m(r,e+1);return d(h,t)&&!d(g,n)||d(g,t)&&!d(h,a)?"\\u"+b(f(t,0),16):t},y=c((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&a({target:"JSON",stat:!0,forced:y},{stringify:function(t,e,r){for(var a=0,n=arguments.length,o=l(n);a<n;a++)o[a]=arguments[a];var i=s(u,null,o);return"string"==typeof i?p(i,v,k):i}})},f2aa:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"membercart"}},[r("b-container",{staticClass:"contentMt"},[r("b-table",{attrs:{items:t.products,fields:t.fields,"tbody-tr-class":t.rowClass},scopedSlots:t._u([{key:"cell(image)",fn:function(e){return[e.item.product.image?r("img",{staticStyle:{height:"50px"},attrs:{src:e.item.product.image}}):t._e()]}},{key:"cell(name)",fn:function(e){return[t._v(t._s(e.item.product.name))]}},{key:"cell(price)",fn:function(e){return[t._v(t._s(e.item.product.price))]}},{key:"cell(action)",fn:function(e){return[r("b-form-spinbutton",{staticClass:"mr-3",attrs:{min:"1",inline:""},on:{input:function(r){return t.updateCart(e.index,e.item.quantity)}},model:{value:e.item.quantity,callback:function(r){t.$set(e.item,"quantity",r)},expression:"data.item.quantity"}}),t._v("  "),r("b-btn",{attrs:{variant:"light"},on:{click:function(r){return t.updateCart(e.index,0)}}},[t._v("🗑️")])]}}])}),r("p",{staticClass:"text-center"},[t._v("總金額 "+t._s(t.total))]),r("div",{staticClass:"mt-5"},[r("h4",[t._v("聯絡資訊")]),r("b-form",{on:{submit:function(t){t.stopPropagation(),t.preventDefault()},reset:t.onReset}},[r("b-row",[r("b-col",{attrs:{cols:"6"}},[r("label",{attrs:{for:"feedback-name"}},[t._v("訂購人姓名")]),r("b-form-input",{attrs:{id:"feedback-name",state:t.validation.name},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),r("b-form-invalid-feedback",{attrs:{state:t.validation.name}},[t._v("必填欄位")]),r("b-form-valid-feedback",{attrs:{state:t.validation.name}},[t._v("Ok")])],1),r("b-col",{attrs:{cols:"6"}},[r("label",{attrs:{for:"feedback-phone"}},[t._v("聯絡電話")]),r("b-form-input",{attrs:{id:"feedback-phone",state:t.validation.phone},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}}),r("b-form-invalid-feedback",{attrs:{state:t.validation.phone}},[t._v("若為市內電話需加區碼(例如:台北02)")]),r("b-form-valid-feedback",{attrs:{state:t.validation.phone}},[t._v("Ok")])],1),r("b-col",{attrs:{cols:"12"}},[r("b-form-group",{staticStyle:{"margin-top":"10px"},attrs:{id:"input-group-3",label:"欲送達地址:","label-for":"input-3"}}),r("b-form-input",{staticStyle:{"margin-top":"-10px"},attrs:{id:"input-3",placeholder:"自取不用填寫"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),r("b-col",{staticClass:"mt-3",attrs:{cols:"6"}},[r("b-form-radio-group",{attrs:{options:t.options1,state:t.state,name:"radio-validation"},model:{value:t.form.courier,callback:function(e){t.$set(t.form,"courier",e)},expression:"form.courier"}},[r("b-form-invalid-feedback",{attrs:{state:t.state}},[t._v("請選擇其中一項")]),r("b-form-valid-feedback",{attrs:{state:t.state}},[t._v("ok")])],1)],1),r("b-col",{staticClass:"mt-3",attrs:{cols:"6"}},[r("h3",[t._v("付款方式：ATM")])]),r("b-col",{staticClass:"mt-3",attrs:{cols:"6"}},[r("label",{attrs:{for:"example-datepicker"}},[t._v("請選擇日期")]),r("b-form-datepicker",{staticClass:"mb-2",attrs:{id:"example-datepicker",dark:!0,state:!0,"selected-variant":"warning","reset-button":""},model:{value:t.form.deliveryDate,callback:function(e){t.$set(t.form,"deliveryDate",e)},expression:"form.deliveryDate"}})],1),r("b-col",{staticClass:"mt-3",attrs:{lg:"6"}},[r("label",{attrs:{id:"label",for:"timepicker-placeholder"}},[t._v("請選擇時間")]),r("b-time",{attrs:{id:"time",placeholder:"Choose a time",locale:"en"},model:{value:t.form.deliveryTime,callback:function(e){t.$set(t.form,"deliveryTime",e)},expression:"form.deliveryTime"}})],1),r("b-col",{staticClass:"mt-3",attrs:{cols:"12"}},[r("img-inputer",{attrs:{accept:"image/*",theme:"light",size:"large","bottom-text":"點選或拖拽圖片以修改","hover-text":"點選或拖拽圖片以修改",placeholder:"點選或拖拽選擇圖片","max-size":1024,"exceed-size-text":"檔案大小不能超過"},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}})],1),r("b-col",{attrs:{lg:"12"}},[r("b-form-textarea",{staticClass:"mt-3",attrs:{id:"textarea",placeholder:"留言給店家",rows:"3","max-rows":"6"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),r("b-row",{staticClass:"d-flex justify-content-end pr-3"},[r("b-btn",{staticClass:"mt-3",attrs:{type:"reset",variant:"danger"}},[t._v("打錯重來")]),r("b-btn",{staticClass:"mt-3 ml-3",attrs:{variant:"primary",disabled:0===t.products.length},on:{click:t.checkout}},[t._v("結帳")])],1)],1)],1)],1)],1)},n=[],o=r("1da1"),s=(r("96cf"),r("a434"),r("e9c4"),r("b0c0"),r("d3b7"),{data:function(){return{products:[],fields:[{key:"image",label:"圖片"},{key:"name",label:"名稱"},{key:"price",label:"價格"},{key:"action",label:"數量"}],options1:[{text:"宅配",value:"宅配"},{text:"自取",value:"自取"}],form:{name:"",phone:"",address:"",courier:"",deliveryDate:"",deliveryTime:"",total:"",image:null,remark:""}}},methods:{updateCart:function(t,e){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,r.api.patch("/users/me/cart",{product:r.products[t].product._id,quantity:e},{headers:{authorization:"Bearer "+r.user.token}});case 3:0===e&&(r.products.splice(t,1),r.$store.commit("user/updateCart",r.user.cart-1)),a.next=10;break;case 6:a.prev=6,a.t0=a["catch"](0),console.log(a.t0),r.$swal({icon:"error",title:"失敗",text:"修改購物車失敗"});case 10:case"end":return a.stop()}}),a,null,[[0,6]])})))()},checkout:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a in r=new FormData,t.form)"_id"!==a&&r.append(a,t.form[a]),console.log(r);return e.prev=2,e.next=5,t.api.post("/orders",r,{headers:{authorization:"Bearer "+t.user.token}});case 5:t.$router.push("/orders"),t.$store.commit("user/updateCart",0),t.$swal({icon:"success",title:"成功",text:"送出訂單，專人將於上班日兩天內與您聯絡"}),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0),t.$swal({icon:"error",title:"失敗",text:"結帳失敗"});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},rowClass:function(t,e){if(t&&"row"===e)return t.product.sell?"":"bg-danger"},onSubmit:function(t){t.preventDefault(),alert(JSON.stringify(this.form))},onReset:function(t){var e=this;t.preventDefault(),this.form.name="",this.form.phone="",this.form.address="",this.form.courier="",this.form.remark="",this.show=!1,this.$nextTick((function(){e.show=!0}))}},computed:{validation:function(){return{name:this.form.name.length>=1,phone:10===this.form.phone.length}},state:function(){return Boolean(this.form.courier)},total:function(){return this.products.reduce((function(t,e){return t+e.quantity*e.product.price}),0)}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.get("/users/me/cart",{headers:{authorization:"Bearer "+t.user.token}});case 3:r=e.sent,a=r.data,t.products=a.result,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$swal({icon:"error",title:"失敗",text:"取得購物車失敗"});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}),i=s,c=r("2877"),l=Object(c["a"])(i,a,n,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=Member.7fab1d81.js.map